<% if @product.nil? %>
	Product not found!
<% else %>
	<h1 ><%= @product.name_and_version %></h1>
	<div>
		<div style="float:right">
			<%= render :partial => 'shared/show_rate', :locals => {:rate => @product.version_rate, :id => @product.prod_key} %>
		</div>
		<div style="width: 150px;">
			<% if signed_in? %>
				<% if @follower.nil? %>			
					<%= form_tag("/follow") do  %>
						<input id="product_key_hidden"  name="product_key" type="hidden" value="<%= @product.to_param %>"/>
						<%= submit_tag "Follow", :class => "followButton", :id => "#{@product.to_param}" %>
					<% end %>
				<% else %>
					<%= form_tag("/unfollow") do  %>
						<input id="src_hidden"  name="src_hidden" type="hidden" value="detail"/>
						<input id="product_key_hidden"  name="product_key" type="hidden" value="<%= @product.to_param %>"/>
						<%= submit_tag "Unfollow", :class => "unfollowButton" %>
					<% end %>
				<% end %>
			<% else %>
				<input type="submit" value="Follow" class="followButton" onclick="load_dialog_follow('<%= @product.name %>');" ></input>
			<% end %>				
		</div>	
	<div class="boxHeader">
		Link to product
	</div>
	<div class="boxContainer" >
		<a href="<%= @product.version_link %>" target="_NEW"><%= @product.version_link %></a>
	</div>
	<div class="boxHeader">
		Maven2 pom.xml snippet
	</div>
	<div class="boxContainer"><pre>
<<span>dependency</span>>
	<<span>groupId</span>><b><%= @product.group_id %></b><<span>/groupId</span>>
	<<span>artifactId</span>><b><%= @product.artifact_id %></b><<span>/artifactId</span>>
	<<span>version</span>><b><%= @product.version %></b><<span>/version</span>>
<<span>/dependency</span>></pre>
	</div>
	<div class="boxHeader">
		Repository
	</div>
	<div class="boxContainer">
		<% @product.repositories.each do |repo| %>
			<div><a href="<%= repo.src %>" target="_NEW" ><%= repo.src %></a> </div>
		<% end %>		
	</div>
	<% if !@product.versions.nil? && @product.versions.length > 1 %>
		<div class="boxHeader">
			Other Versions
		</div>
		<div class="boxContainer" >
			<table>
			<% @product.get_natural_sorted_versions.each do |version|  %>
				<tr>
					<td>
						<a href="/product/<%=@product.to_param%>/version/<%=version.to_url_param%>"><%=version.version%></a>
					</td>
					<td><a href="<%= version.link %>"><%= version.link %></a></td>
				</tr>
			<% end %>
			</table>
		</div>
	<% end %>

	<% if signed_in? %>
		<div class="boxHeader">
			Leave rating &amp; comment
		</div>
		<div class="boxContainer">
			<%= form_for @versioncomment do |f| %>
			    <div class="messages">
			        <%= render 'shared/error_messages', :object => f.object %>
			    </div>				
				<div >
					<input name="versioncomment[rate]" type="radio" value="10" class="star"/>
					<input name="versioncomment[rate]" type="radio" value="20" class="star"/>
					<input name="versioncomment[rate]" type="radio" value="30" class="star"/>
					<input name="versioncomment[rate]" type="radio" value="40" class="star"/>
					<input name="versioncomment[rate]" type="radio" value="50" class="star"/>					
				</div>
				<div >
					<%= f.text_area :comment, :class => "round", :maxlength => "1000", :onKeyUp => "textCounter(this, document.getElementById('counter'), 1000)"  %>
					<%= f.hidden_field :product_key, :value => @product.prod_key %>
					<%= f.hidden_field :version, :value => @product.version %>
				</div>
				<div style="display: inline-block; width: 640px;">
					<div style="float: left">
						<%= f.submit "Save", :class => "button" %>
					</div>						
					<div style="float: right" class="grayText">
						Characters left: <span class="grayText" id="counter">1000</span>
					</div>
				</div>
			<% end %>
		</div>
	<% elsif %>
		<div class="boxHeader">
			Leave rating &amp; comment
		</div>
		<div class="boxContainer">
			<%= link_to "Sign Up", signup_path %> or <%= link_to "Sign In", signin_path %> to leave rating and comment. 
		</div>
	<% end %>
	
	<% if !@comments.nil? && @comments.length > 0 %>
		<div class="boxHeader">
			Comments
		</div>
		<div class="boxContainer" >
			<table>				
			<% @comments.each do |comment|  %>
				<tr>
					<td>
						<div>
							<%= render :partial => 'shared/show_rate', :locals => {:rate => comment.rate, :id => comment.id} %>
							<br/>
						<div>
						<div class="commentHead">
							<%= comment.user.fullname %> on <%= comment.created_at.strftime("%b %d, %Y - %I:%m %p") %>							
						</div>
						<div>
							<%= comment.comment %>
						</div>						
					</td>
				</tr>
			<% end %>
			</table>
		</div>
	<% end %>
	
<% end %>